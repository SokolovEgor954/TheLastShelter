{% extends "base.html" %}
{% set active_page = 'home' %}

{% block title %}–û—Å—Ç–∞–Ω–Ω—ñ–π –ü—Ä–∏—Ö–∏—Å—Ç–æ–∫ v3.0 ‚Äî –ì–æ–ª–æ–≤–Ω–∞{% endblock %}

{% block extra_head %}
<style>
/* ‚ïê‚ïê HERO ‚ïê‚ïê */
.hero-wrap {
    text-align: center;
    padding: 3rem 0 2rem;
    position: relative;
}

/* –í–µ—Ä—Å—ñ–π–Ω–∏–π –±–µ–π–¥–∂ */
.version-badge {
    display: inline-block;
    border: 1px solid rgba(76,255,128,0.5);
    padding: 3px 14px;
    border-radius: 2px;
    font-size: 0.75rem;
    letter-spacing: 3px;
    text-transform: uppercase;
    opacity: 0.7;
    margin-bottom: 1.2rem;
    animation: fadeIn 0.5s ease forwards;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
.hero-title {
    font-size: clamp(2.2rem, 6vw, 3.8rem);
    letter-spacing: 4px;
    text-transform: uppercase;
    text-shadow: 0 0 18px rgba(76,255,128,1), 0 0 40px rgba(76,255,128,0.4);
    margin: 0 0 0.4rem;
    animation: fadeIn 0.6s ease 0.1s both;
}

.hero-subtitle {
    font-size: 1.05rem;
    opacity: 0.6;
    margin-bottom: 2rem;
    animation: fadeIn 0.6s ease 0.2s both;
}

/* –ö–Ω–æ–ø–∫–∏ hero */
.hero-actions {
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
    animation: fadeIn 0.6s ease 0.3s both;
}

/* ‚ïê‚ïê TYPEWRITER ‚ïê‚ïê */
.typewriter-wrap {
    font-size: 1rem;
    opacity: 0.75;
    min-height: 1.5em;
    margin-top: 0.5rem;
}
.typewriter-text::after {
    content: '‚ñã';
    animation: blink 0.9s step-start infinite;
}
@keyframes blink { 50% { opacity: 0; } }

/* ‚ïê‚ïê –°–¢–ê–¢–£–°-–†–Ø–î–û–ö ‚ïê‚ïê */
.status-bar {
    display: flex;
    justify-content: center;
    gap: 24px;
    flex-wrap: wrap;
    margin: 1.6rem 0;
    animation: fadeIn 0.6s ease 0.4s both;
}
.status-item {
    font-size: 0.78rem;
    opacity: 0.55;
    letter-spacing: 1px;
}
.status-dot {
    display: inline-block;
    width: 7px; height: 7px;
    border-radius: 50%;
    background: #4cff80;
    box-shadow: 0 0 6px #4cff80;
    margin-right: 5px;
    animation: pulse 2s ease-in-out infinite;
}
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:0.3} }

/* ‚ïê‚ïê –°–Ü–¢–ö–ê –§–Ü–ß ‚ïê‚ïê */
.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 12px;
    margin: 2rem 0;
}
.feature-card {
    border: 1px solid rgba(76,255,128,0.25);
    border-radius: 4px;
    padding: 18px;
    background: rgba(10,15,10,0.9);
    transition: 0.2s;
    opacity: 0;
    animation: fadeUp 0.4s ease forwards;
}
.feature-card:hover {
    border-color: #4cff80;
    box-shadow: 0 0 14px rgba(76,255,128,0.2);
    transform: translateY(-2px);
}
.feature-icon { font-size: 1.5rem; margin-bottom: 8px; }
.feature-title { font-size: 0.9rem; color: #4cff80; margin-bottom: 4px; }
.feature-desc  { font-size: 0.78rem; opacity: 0.5; line-height: 1.5; }

/* ‚ïê‚ïê CHANGELOG v3.0 ‚ïê‚ïê */
.changelog {
    border-left: 2px solid rgba(76,255,128,0.4);
    padding-left: 16px;
    margin: 0;
}
.changelog-item {
    padding: 6px 0;
    font-size: 0.88rem;
    border-bottom: 1px solid rgba(76,255,128,0.07);
    opacity: 0.8;
}
.changelog-item:last-child { border-bottom: none; }
.changelog-tag {
    font-size: 0.7rem;
    padding: 1px 7px;
    border-radius: 2px;
    margin-right: 8px;
    vertical-align: middle;
}
.tag-new  { background: rgba(76,255,128,0.15); border: 1px solid rgba(76,255,128,0.4); color: #4cff80; }
.tag-fix  { background: rgba(255,200,0,0.1);   border: 1px solid rgba(255,200,0,0.4);  color: #ffc800; }
.tag-upd  { background: rgba(100,180,255,0.1); border: 1px solid rgba(100,180,255,0.3); color: #64b4ff; }

/* ‚ïê‚ïê –ó–ê–ì–ê–õ–¨–ù–Ü ‚ïê‚ïê */
@keyframes fadeIn  { from { opacity:0; }                       to { opacity:1; } }
@keyframes fadeUp  { from { opacity:0; transform:translateY(12px); } to { opacity:1; transform:translateY(0); } }

/* –Æ–∑–µ—Ä-–ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è */
.user-greeting {
    font-size: 1rem;
    margin-top: 1rem;
    opacity: 0.8;
    animation: fadeIn 0.5s ease 0.5s both;
}
</style>
{% endblock %}

{% block content %}

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HERO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="hero-wrap">

    <div class="version-badge">‚ò¢ –≤–µ—Ä—Å—ñ—è 2.0 ‚Äî —Ä–µ–ª—ñ–∑ 2077</div>

    <h1 class="hero-title">–û–°–¢–ê–ù–ù–Ü–ô –ü–†–ò–•–ò–°–¢–û–ö</h1>
    <p class="hero-subtitle">–¢—É—Ç –Ω–µ–º–∞—î —Å–≤—ñ—Ç–ª–∞. –Ñ –ª–∏—à–µ –≤–æ–≥–æ–Ω—å –∫—É—Ö–Ω—ñ.</p>

    <!-- Typewriter -->
    <div class="typewriter-wrap">
        > <span class="typewriter-text" id="typewriter"></span>
    </div>

    <!-- –°—Ç–∞—Ç—É—Å-—Ä—è–¥–∫–∏ -->
    <div class="status-bar">
        <span class="status-item"><span class="status-dot"></span>–°–ò–°–¢–ï–ú–ê –û–ù–õ–ê–ô–ù</span>
        <span class="status-item"><span class="status-dot" style="animation-delay:0.4s"></span>–ú–ï–ù–Æ –ê–ö–¢–ò–í–ù–ï</span>
        <span class="status-item"><span class="status-dot" style="animation-delay:0.8s"></span>–ö–£–•–ù–Ø –ü–†–ê–¶–Æ–Ñ</span>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ -->
    <div class="hero-actions">
        <a href="/menu" class="btn btn-haven" style="font-size:1.05rem; padding:13px 30px;">
            ‚ò∞ –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –º–µ–Ω—é
        </a>
        {% if not current_user.is_authenticated %}
        <a href="/register" class="btn btn-outline-haven" style="font-size:1.05rem; padding:13px 30px;">
            ‚ò¢ –ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—å
        </a>
        {% else %}
        <a href="/reserved" class="btn btn-outline-haven" style="font-size:1.05rem; padding:13px 30px;">
            ü™ë –ó–∞–±—Ä–æ–Ω—é–≤–∞—Ç–∏ —Å—Ç—ñ–ª
        </a>
        {% endif %}
    </div>

    {% if current_user.is_authenticated %}
    <div class="user-greeting">
        > –í—ñ—Ç–∞—î–º–æ –Ω–∞–∑–∞–¥, <span class="terminal-highlight">{{ current_user.nickname }}</span>.
        –°–∏—Å—Ç–µ–º–∞ –≤–∞—Å –≤–ø—ñ–∑–Ω–∞–ª–∞.
    </div>
    {% endif %}

</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –§–Ü–ß–Ü v3.0 ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="terminal-panel mb-4">
    <div class="terminal-header d-flex justify-content-between align-items-center">
        <span class="terminal-title">[ –©–û –ù–û–í–û–ì–û –£ v3.0 ]</span>
        <span class="terminal-code">CHANGELOG</span>
    </div>
    <div class="terminal-body pt-2">
        <ul class="changelog">
            <li class="changelog-item">
                <span class="changelog-tag tag-new">NEW</span>
                –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ —Å—Ö–µ–º–∞ –∑–∞–ª—É ‚Äî –æ–±–∏—Ä–∞–π —Å—Ç–æ–ª–∏–∫ –ø—Ä—è–º–æ –Ω–∞ –∫–∞—Ä—Ç—ñ
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-new">NEW</span>
                –°–∏—Å—Ç–µ–º–∞ –≤—ñ–¥–≥—É–∫—ñ–≤ –∑ —Ä–µ–π—Ç–∏–Ω–≥–æ–º –Ω–∞ –∫–æ–∂–Ω—É —Å—Ç—Ä–∞–≤—É
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-new">NEW</span>
                Email-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è, –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è —Ç–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-new">NEW</span>
                –°–∫–∏–¥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è —á–µ—Ä–µ–∑ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-new">NEW</span>
                Telegram-–±–æ—Ç ‚Äî —Ç—Ä–µ–∫–µ—Ä –∑–∞–º–æ–≤–ª–µ–Ω—å, –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è, –º–µ–Ω—é
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-new">NEW</span>
                –¢—Ä–µ–∫–µ—Ä —Å—Ç–∞—Ç—É—Å—É –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚Äî –ù–æ–≤–µ ‚Üí –ì–æ—Ç—É—î—Ç—å—Å—è ‚Üí –ì–æ—Ç–æ–≤–æ ‚Üí –î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-upd">UPD</span>
                –ü–æ—à—É–∫ —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –º–µ–Ω—é –∑–∞ –Ω–∞–∑–≤–æ—é, —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∞–º–∏ —ñ —Ü—ñ–Ω–æ—é
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-upd">UPD</span>
                –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å: —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —é–∑–µ—Ä–∞–º–∏, –º–µ–Ω—é, –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è–º–∏
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-upd">UPD</span>
                –°–∫–∞—Å—É–≤–∞–Ω–Ω—è –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è —é–∑–µ—Ä–æ–º —á–µ—Ä–µ–∑ —Å–∞–π—Ç —Ç–∞ Telegram
            </li>
            <li class="changelog-item">
                <span class="changelog-tag tag-fix">FIX</span>
                CSP-—Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å ‚Äî –≤—Å—ñ —Å–∫—Ä–∏–ø—Ç–∏ —á–µ—Ä–µ–∑ nonce
            </li>
        </ul>
    </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê –ú–û–ñ–õ–ò–í–û–°–¢–Ü ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="features-grid">
    <div class="feature-card" style="animation-delay:0.05s">
        <div class="feature-icon">‚ò∞</div>
        <div class="feature-title">–ú–µ–Ω—é –ü—Ä–∏—Ö–∏—Å—Ç–∫—É</div>
        <div class="feature-desc">–°—Ç—Ä–∞–≤–∏ –°—Ç–∞—Ä–æ–≥–æ –°–≤—ñ—Ç—É. –ö–æ–∂–Ω–∞ –ø–æ–∑–∏—Ü—ñ—è ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å, –≤–∞–≥–∞ —Ç–∞ —Ü—ñ–Ω–∞.</div>
    </div>
    <div class="feature-card" style="animation-delay:0.1s">
        <div class="feature-icon">üõí</div>
        <div class="feature-title">–ö–æ—à–∏–∫ —Ç–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</div>
        <div class="feature-desc">–î–æ–¥–∞–≤–∞–π —Å—Ç—Ä–∞–≤–∏ –≤ –∫–æ—à–∏–∫ —ñ –≤—ñ–¥—Å—Ç–µ–∂—É–π —ñ—Å—Ç–æ—Ä—ñ—é —Å–≤–æ—ó—Ö –∑–∞–º–æ–≤–ª–µ–Ω—å.</div>
    </div>
    <div class="feature-card" style="animation-delay:0.15s">
        <div class="feature-icon">ü™ë</div>
        <div class="feature-title">–ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è —Å—Ç–æ–ª–∏–∫—ñ–≤</div>
        <div class="feature-desc">–ó–∞–±—Ä–æ–Ω—é–π –º—ñ—Å—Ü–µ —É –ü—Ä–∏—Ö–∏—Å—Ç–∫—É. –î–æ—Å—Ç—É–ø–Ω–æ –ª–∏—à–µ –¥–ª—è –≤–∏–∂–∏–≤—à–∏—Ö —É –∑–æ–Ω—ñ 20 –∫–º.</div>
    </div>
    <div class="feature-card" style="animation-delay:0.2s">
        <div class="feature-icon">üë§</div>
        <div class="feature-title">–û—Å–æ–±–æ–≤–∞ —Å–ø—Ä–∞–≤–∞</div>
        <div class="feature-desc">–ü—Ä–æ—Ñ—ñ–ª—å –≤–∏–∂–∏–≤—à–∏ –∑—ñ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ—é, –∫–µ—Ä—É–≤–∞–Ω–Ω—è–º –∞–∫–∞—É–Ω—Ç–æ–º —Ç–∞ –±–µ–∑–ø–µ–∫–æ—é.</div>
    </div>
</div>

<!-- –ì–æ—Å—Ç—ñ -->
{% if not current_user.is_authenticated %}
<div class="terminal-panel">
    <div class="terminal-header">
        <span class="terminal-title">[ –î–û–°–¢–£–ü –û–ë–ú–ï–ñ–ï–ù–û ]</span>
        <span class="terminal-code">STATUS: GUEST</span>
    </div>
    <div class="terminal-body">
        <p>> –î–ª—è –∑–∞–º–æ–≤–ª–µ–Ω—å —Ç–∞ –±—Ä–æ–Ω—é–≤–∞–Ω—å –Ω–µ–æ–±—Ö—ñ–¥–Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É —Å–∏—Å—Ç–µ–º—ñ –ü—Ä–∏—Ö–∏—Å—Ç–∫—É.</p>
        <div class="d-flex gap-3 mt-3 flex-wrap">
            <a href="/register" class="btn btn-haven">‚ò¢ –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å</a>
            <a href="/login" class="btn btn-outline-haven">‚Üí –£–≤—ñ–π—Ç–∏</a>
        </div>
    </div>
</div>
{% endif %}

{% endblock %}

{% block extra_scripts %}
<script nonce="{{ nonce if nonce else '' }}">
document.addEventListener('DOMContentLoaded', function() {
    const phrases = [
        "–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ –û—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –ü—Ä–∏—Ö–∏—Å—Ç–∫—É...",
        "–í–µ—Ä—Å—ñ—è 2.0 –≤–∂–µ –¥–æ—Å—Ç—É–ø–Ω–∞.",
        "–ö—É—Ö–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–∞. –°—Ç–æ–ª–∏–∫–∏ —á–µ–∫–∞—é—Ç—å.",
        "–ú–µ–Ω—é –°—Ç–∞—Ä–æ–≥–æ –°–≤—ñ—Ç—É –æ–Ω–æ–≤–ª–µ–Ω–æ.",
        "–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏: 50.45¬∞N / 30.52¬∞E",
        "–ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è —Å—Ç–æ–ª–∏–∫—ñ–≤ —Ç–µ–ø–µ—Ä –¥–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–ª–∞–π–Ω.",
    ];
    let pi = 0, ci = 0, deleting = false;
    const el = document.getElementById('typewriter');
    if (!el) return;

    function type() {
        const phrase = phrases[pi];
        if (!deleting) {
            el.textContent = phrase.slice(0, ++ci);
            if (ci === phrase.length) {
                deleting = true;
                setTimeout(type, 1800);
                return;
            }
        } else {
            el.textContent = phrase.slice(0, --ci);
            if (ci === 0) {
                deleting = false;
                pi = (pi + 1) % phrases.length;
            }
        }
        setTimeout(type, deleting ? 30 : 60);
    }
    type();
});
</script>
{% endblock %}