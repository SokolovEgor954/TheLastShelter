{% extends "base.html" %}
{% set active_page = 'reserved' %}

{% block title %}–ú–æ—ó –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è ‚Äî –û—Å—Ç–∞–Ω–Ω—ñ–π –ü—Ä–∏—Ö–∏—Å—Ç–æ–∫{% endblock %}

{% block extra_head %}
<style>
.reserv-card {
    border: 1px solid rgba(76,255,128,0.35);
    border-radius: 4px;
    background: rgba(10,15,10,0.92);
    padding: 18px 20px;
    transition: 0.2s;
    opacity: 0;
    transform: translateY(12px);
    animation: fadeUp 0.35s ease forwards;
}
.reserv-card:hover {
    border-color: #4cff80;
    box-shadow: 0 0 14px rgba(76,255,128,0.25);
}
@keyframes fadeUp { to { opacity:1; transform:translateY(0); } }

.reserv-meta {
    font-size: 0.82rem;
    opacity: 0.55;
    text-transform: uppercase;
    letter-spacing: 1px;
}
.reserv-time {
    font-size: 1.15rem;
    color: #4cff80;
    text-shadow: 0 0 8px rgba(76,255,128,0.7);
}
.table-badge {
    display: inline-block;
    border: 1px solid #4cff80;
    padding: 2px 10px;
    border-radius: 3px;
    font-size: 0.8rem;
    opacity: 0.8;
}
.btn-del {
    font-family: "Share Tech Mono", monospace;
    font-size: 0.78rem;
    padding: 6px 14px;
    border-radius: 3px;
    border: 1px solid rgba(255,60,60,0.35);
    background: rgba(255,60,60,0.06);
    color: rgba(255,80,80,0.8);
    cursor: pointer;
    transition: 0.15s;
    white-space: nowrap;
}
.btn-del:hover { background: rgba(255,60,60,0.15); border-color: #ff5050; color: #ff5050; }
</style>
{% endblock %}

{% block content %}

<div class="terminal-panel mb-4">
    <div class="terminal-header d-flex justify-content-between align-items-center">
        <span class="terminal-title">[ –ú–û–á –ë–†–û–ù–Æ–í–ê–ù–ù–Ø ]</span>
        <span class="terminal-code">NODE: RESERV-LIST</span>
    </div>
    <div class="terminal-body">
        <p>> –ü–µ—Ä–µ–ª—ñ–∫ —É—Å—ñ—Ö –∑–∞–±—Ä–æ–Ω—å–æ–≤–∞–Ω–∏—Ö –º—ñ—Å—Ü—å —É –ü—Ä–∏—Ö–∏—Å—Ç–∫—É.</p>
    </div>
</div>

<!-- Flash -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-haven alert-{{ category }} mb-3">{{ message }}</div>
        {% endfor %}
    {% endif %}
{% endwith %}

{% if reservations %}
    <div class="d-flex flex-column gap-3 mb-4">
    {% for r in reservations %}
        <div class="reserv-card" style="animation-delay: {{ loop.index0 * 0.07 }}s">
            <div class="d-flex justify-content-between align-items-start flex-wrap gap-3">

                <div>
                    <div class="reserv-meta mb-1">–ë–†–û–ù–Æ–í–ê–ù–ù–Ø #{{ r.id }}</div>
                    <div class="reserv-time mb-2">‚ò¢ {{ r.time_start.strftime('%d.%m.%Y %H:%M') }}</div>
                    <span class="table-badge">ü™ë –°—Ç–æ–ª–∏–∫ ‚Ññ{{ r.table_number }} ‚Äî {{ r.table_label }} ({{ r.table_type }} –æ—Å.)</span>
                </div>

                <div class="d-flex gap-2 align-items-center flex-wrap">
                    <a href="/edit_reservation/{{ r.id }}" class="btn btn-haven btn-sm">
                        ‚úé –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                    </a>
                    <form method="post" action="/reservation/cancel/{{ r.id }}">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                        <button type="submit" class="btn-del">‚úñ –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    </form>
                </div>

            </div>
        </div>
    {% endfor %}
    </div>
{% else %}
    <div class="terminal-panel mb-4">
        <div class="terminal-header">
            <span class="terminal-title">[ –ù–Ü–ß–û–ì–û –ù–ï –ó–ù–ê–ô–î–ï–ù–û ]</span>
        </div>
        <div class="terminal-body">
            <p>> –£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö –±—Ä–æ–Ω—é–≤–∞–Ω—å.</p>
        </div>
    </div>
{% endif %}

<!-- –ö–Ω–æ–ø–∫–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó -->
<div class="d-flex gap-3 flex-wrap">
    <a href="/reserved" class="btn btn-haven">+ –ù–æ–≤–µ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è</a>
    <a href="/profile" class="btn btn-outline-haven">‚Üê –ü—Ä–æ—Ñ—ñ–ª—å</a>
</div>

{% endblock %}